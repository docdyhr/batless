[38;2;117;113;94m//![0m[38;2;117;113;94m Core functionality for batless - a minimal, AI-friendly code viewer[0m
[38;2;117;113;94m//![0m
[38;2;117;113;94m//![0m[38;2;117;113;94m This library provides the core logic for syntax highlighting and file processing[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m that can be used both by the CLI and in tests.[0m

[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m::[0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfs[0m[38;2;248;248;242m::[0m[38;2;248;248;242mFile[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mBufRead[0m[38;2;248;248;242m,[0m[38;2;248;248;242m BufReader[0m[38;2;248;248;242m,[0m[38;2;248;248;242m Read[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mpath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mPath[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242measy[0m[38;2;248;248;242m::[0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mparsing[0m[38;2;248;248;242m::[0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mutil[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mas_24_bit_terminal_escaped[0m[38;2;248;248;242m,[0m[38;2;248;248;242m LinesWithEndings[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;117;113;94m//[0m[38;2;117;113;94m Cache syntax and theme sets for better performance[0m
[38;2;248;248;242mlazy_static![0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m SyntaxSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults_newlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m ThemeSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mderive[0m[38;2;248;248;242m([0m[38;2;248;248;242mClone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;102;217;239musize[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtheme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mstrip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255muse_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255minclude_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;102;217;239mimpl[0m[38;2;248;248;242m [0m[38;2;248;248;242mDefault [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            theme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            strip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mFileInfo[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mencoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msyntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Read and process a file according to the given configuration[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mprocess_file[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;248;248;242mFileInfo, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Detect encoding[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mvec![0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;190;132;255m1024.[0m[38;2;102;217;239mmin[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmetadata[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114mas[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m bytes_read [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mread[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    buffer[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;248;248;242mbytes_read[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m_encoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m_[0m[38;2;248;248;242m,[0m[38;2;248;248;242m had_errors[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mencoding_rs[0m[38;2;248;248;242m::[0m[38;2;190;132;255mUTF_8[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdecode[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mbuffer[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m encoding_name [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mhad_errors [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUnknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Reset file position[0m
[38;2;248;248;242m    file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m reader [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBufReader[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m all_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m For summary mode processing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m First pass: collect all lines if summary mode or collect limited lines[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line_result [0m[38;2;249;38;114min[0m[38;2;248;248;242m reader[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line_result[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m+[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m +1 for newline[0m

[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            all_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m>=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mif[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m+[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m>[0m[38;2;248;248;242m max_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                    truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        line_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        byte_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m line_bytes[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Process summary if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mextract_summary[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mall_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m If summary mode, replace lines with summary for output[0m
[38;2;248;248;242m        lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Extract tokens if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;249;38;114mref[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;102;217;239mextract_tokens[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m file_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mFileInfo [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m line_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m byte_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_bytes[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        encoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m encoding_name[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        syntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m TODO: Implement syntax error detection[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        summary_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Apply syntax highlighting to content[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mhighlight_content[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Use cached syntax and theme sets[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m theme [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mok_or[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to load theme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Determine syntax based on file extension or explicit language[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m syntax [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_name[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_extension[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m highlighter [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m,[0m[38;2;248;248;242m theme[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mString[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m [0m[38;2;248;248;242mLinesWithEndings[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfrom[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m ranges[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mStyle, [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            highlighter[0m[38;2;248;248;242m.[0m[38;2;102;217;239mhighlight_line[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m escaped [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mas_24_bit_terminal_escaped[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mranges[0m[38;2;248;248;242m[[0m[38;2;249;38;114m..[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        result[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush_str[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mescaped[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Detect the language of a file based on its extension[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdetect_language[0m[38;2;248;248;242m([0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all supported languages[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m languages[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239msyntaxes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31msyntax[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all available themes[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m themes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mkeys[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcloned[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract summary information from code (function signatures, class definitions, imports)[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_summary[0m[38;2;248;248;242m([0m[38;2;253;151;31mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242m[String], [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;102;217;239mis_important_comment[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mcontinue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-agnostic patterns for important code structures[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    summary[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a line contains summary-worthy code[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Skip empty lines and comments[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-specific important patterns[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mmatch[0m[38;2;248;248;242m language[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_ref[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfrom [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m@[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Only match function/struct/enum declarations, not their contents[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtrait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub trait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimpl [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub const [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstatic [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub static [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mJavaScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m|[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mTypeScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116minterface [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m_[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Generic patterns for unknown languages - only top-level declarations[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mmodule [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a comment is important enough to include in summary[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_important_comment[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_lower [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_lowercase[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtodo[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfixme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mhack[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mnote[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m///[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m/**[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#![0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract tokens from content for AI processing[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_tokens[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31m_file_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Simple token extraction - can be enhanced with proper lexing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Basic word-based tokenization[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239msplit_whitespace[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mextend[0m[38;2;248;248;242m([0m[38;2;248;248;242mline_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Remove duplicates and sort[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdedup[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Limit token count to prevent overflow[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m [0m[38;2;190;132;255m1000[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;190;132;255m1000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    tokens[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mcfg[0m[38;2;248;248;242m([0m[38;2;248;248;242mtest[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;102;217;239mmod[0m[38;2;248;248;242m [0m[38;2;166;226;46mtests[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;249;38;114msuper[0m[38;2;248;248;242m::[0m[38;2;249;38;114m*[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242mWrite[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mtempfile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m NamedTempFile[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to create temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mwrite_all[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to write to temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_basic[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m1[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 2[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m2[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 3[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_lines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 4[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 5[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mshort[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mlonger line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116meven longer line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should stop after first two lines[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes [0m[38;2;249;38;114m<=[0m[38;2;248;248;242m [0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_rust[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_python[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.py[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_unknown[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.unknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_none[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m==[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPlain Text[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_plain[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m,[0m[38;2;248;248;242m content[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_with_syntax[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should contain ANSI escape codes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\x1b[0m[38;2;230;219;116m[[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m languages [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m themes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_summary_mode[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            [0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport os[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mdef main():[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    print('hello')[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    x = 1[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mclass Test:[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    pass[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef main[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass Test[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_include_tokens[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    let x = 42;[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mmain()[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_encoding_detection[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mHello, 世界![0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mencoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_config_default[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mstrip_ansi[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_empty_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_single_line_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m Core functionality for batless - a minimal, AI-friendly code viewer[0m
[38;2;117;113;94m//![0m
[38;2;117;113;94m//![0m[38;2;117;113;94m This library provides the core logic for syntax highlighting and file processing[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m that can be used both by the CLI and in tests.[0m

[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m::[0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfs[0m[38;2;248;248;242m::[0m[38;2;248;248;242mFile[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mBufRead[0m[38;2;248;248;242m,[0m[38;2;248;248;242m BufReader[0m[38;2;248;248;242m,[0m[38;2;248;248;242m Read[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mpath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mPath[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242measy[0m[38;2;248;248;242m::[0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mparsing[0m[38;2;248;248;242m::[0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mutil[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mas_24_bit_terminal_escaped[0m[38;2;248;248;242m,[0m[38;2;248;248;242m LinesWithEndings[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;117;113;94m//[0m[38;2;117;113;94m Cache syntax and theme sets for better performance[0m
[38;2;248;248;242mlazy_static![0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m SyntaxSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults_newlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m ThemeSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mderive[0m[38;2;248;248;242m([0m[38;2;248;248;242mClone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;102;217;239musize[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtheme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mstrip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255muse_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255minclude_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;102;217;239mimpl[0m[38;2;248;248;242m [0m[38;2;248;248;242mDefault [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            theme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            strip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mFileInfo[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mencoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msyntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Read and process a file according to the given configuration[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mprocess_file[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;248;248;242mFileInfo, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Detect encoding[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mvec![0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;190;132;255m1024.[0m[38;2;102;217;239mmin[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmetadata[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114mas[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m bytes_read [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mread[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    buffer[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;248;248;242mbytes_read[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m_encoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m_[0m[38;2;248;248;242m,[0m[38;2;248;248;242m had_errors[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mencoding_rs[0m[38;2;248;248;242m::[0m[38;2;190;132;255mUTF_8[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdecode[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mbuffer[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m encoding_name [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mhad_errors [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUnknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Reset file position[0m
[38;2;248;248;242m    file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m reader [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBufReader[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m all_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m For summary mode processing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m First pass: collect all lines if summary mode or collect limited lines[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line_result [0m[38;2;249;38;114min[0m[38;2;248;248;242m reader[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line_result[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m+[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m +1 for newline[0m

[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            all_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m>=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mif[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m+[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m>[0m[38;2;248;248;242m max_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                    truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        line_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        byte_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m line_bytes[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Process summary if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mextract_summary[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mall_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m If summary mode, replace lines with summary for output[0m
[38;2;248;248;242m        lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Extract tokens if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;249;38;114mref[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;102;217;239mextract_tokens[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m file_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mFileInfo [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m line_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m byte_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_bytes[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        encoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m encoding_name[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        syntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m TODO: Implement syntax error detection[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        summary_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Apply syntax highlighting to content[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mhighlight_content[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Use cached syntax and theme sets[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m theme [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mok_or[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to load theme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Determine syntax based on file extension or explicit language[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m syntax [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_name[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_extension[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m highlighter [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m,[0m[38;2;248;248;242m theme[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mString[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m [0m[38;2;248;248;242mLinesWithEndings[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfrom[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m ranges[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mStyle, [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            highlighter[0m[38;2;248;248;242m.[0m[38;2;102;217;239mhighlight_line[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m escaped [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mas_24_bit_terminal_escaped[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mranges[0m[38;2;248;248;242m[[0m[38;2;249;38;114m..[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        result[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush_str[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mescaped[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Detect the language of a file based on its extension[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdetect_language[0m[38;2;248;248;242m([0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all supported languages[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m languages[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239msyntaxes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31msyntax[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all available themes[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m themes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mkeys[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcloned[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract summary information from code (function signatures, class definitions, imports)[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_summary[0m[38;2;248;248;242m([0m[38;2;253;151;31mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242m[String], [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;102;217;239mis_important_comment[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mcontinue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-agnostic patterns for important code structures[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    summary[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a line contains summary-worthy code[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Skip empty lines and comments[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-specific important patterns[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mmatch[0m[38;2;248;248;242m language[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_ref[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfrom [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m@[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Only match function/struct/enum declarations, not their contents[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtrait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub trait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimpl [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub const [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstatic [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub static [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mJavaScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m|[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mTypeScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116minterface [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m_[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Generic patterns for unknown languages - only top-level declarations[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mmodule [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a comment is important enough to include in summary[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_important_comment[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_lower [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_lowercase[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtodo[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfixme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mhack[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mnote[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m///[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m/**[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#![0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract tokens from content for AI processing[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_tokens[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31m_file_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Simple token extraction - can be enhanced with proper lexing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Basic word-based tokenization[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239msplit_whitespace[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mextend[0m[38;2;248;248;242m([0m[38;2;248;248;242mline_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Remove duplicates and sort[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdedup[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Limit token count to prevent overflow[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m [0m[38;2;190;132;255m1000[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;190;132;255m1000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    tokens[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mcfg[0m[38;2;248;248;242m([0m[38;2;248;248;242mtest[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;102;217;239mmod[0m[38;2;248;248;242m [0m[38;2;166;226;46mtests[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;249;38;114msuper[0m[38;2;248;248;242m::[0m[38;2;249;38;114m*[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242mWrite[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mtempfile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m NamedTempFile[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to create temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mwrite_all[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to write to temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_basic[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m1[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 2[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m2[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 3[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_lines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 4[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 5[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mshort[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mlonger line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116meven longer line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should stop after first two lines[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes [0m[38;2;249;38;114m<=[0m[38;2;248;248;242m [0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_rust[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_python[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.py[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_unknown[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.unknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_none[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m==[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPlain Text[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_plain[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m,[0m[38;2;248;248;242m content[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_with_syntax[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should contain ANSI escape codes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\x1b[0m[38;2;230;219;116m[[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m languages [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m themes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_summary_mode[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            [0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport os[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mdef main():[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    print('hello')[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    x = 1[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mclass Test:[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    pass[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef main[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass Test[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_include_tokens[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    let x = 42;[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mmain()[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_encoding_detection[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mHello, 世界![0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mencoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_config_default[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mstrip_ansi[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_empty_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_single_line_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m Core functionality for batless - a minimal, AI-friendly code viewer[0m
[38;2;117;113;94m//![0m
[38;2;117;113;94m//![0m[38;2;117;113;94m This library provides the core logic for syntax highlighting and file processing[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m that can be used both by the CLI and in tests.[0m

[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m::[0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfs[0m[38;2;248;248;242m::[0m[38;2;248;248;242mFile[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mBufRead[0m[38;2;248;248;242m,[0m[38;2;248;248;242m BufReader[0m[38;2;248;248;242m,[0m[38;2;248;248;242m Read[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mpath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mPath[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242measy[0m[38;2;248;248;242m::[0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mparsing[0m[38;2;248;248;242m::[0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mutil[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mas_24_bit_terminal_escaped[0m[38;2;248;248;242m,[0m[38;2;248;248;242m LinesWithEndings[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;117;113;94m//[0m[38;2;117;113;94m Cache syntax and theme sets for better performance[0m
[38;2;248;248;242mlazy_static![0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m SyntaxSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults_newlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m ThemeSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mderive[0m[38;2;248;248;242m([0m[38;2;248;248;242mClone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;102;217;239musize[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtheme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mstrip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255muse_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255minclude_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;102;217;239mimpl[0m[38;2;248;248;242m [0m[38;2;248;248;242mDefault [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            theme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            strip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mFileInfo[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mencoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msyntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Read and process a file according to the given configuration[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mprocess_file[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;248;248;242mFileInfo, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Detect encoding[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mvec![0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;190;132;255m1024.[0m[38;2;102;217;239mmin[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmetadata[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114mas[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m bytes_read [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mread[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    buffer[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;248;248;242mbytes_read[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m_encoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m_[0m[38;2;248;248;242m,[0m[38;2;248;248;242m had_errors[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mencoding_rs[0m[38;2;248;248;242m::[0m[38;2;190;132;255mUTF_8[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdecode[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mbuffer[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m encoding_name [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mhad_errors [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUnknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Reset file position[0m
[38;2;248;248;242m    file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m reader [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBufReader[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m all_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m For summary mode processing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m First pass: collect all lines if summary mode or collect limited lines[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line_result [0m[38;2;249;38;114min[0m[38;2;248;248;242m reader[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line_result[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m+[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m +1 for newline[0m

[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            all_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m>=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mif[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m+[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m>[0m[38;2;248;248;242m max_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                    truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        line_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        byte_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m line_bytes[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Process summary if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mextract_summary[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mall_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m If summary mode, replace lines with summary for output[0m
[38;2;248;248;242m        lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Extract tokens if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;249;38;114mref[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;102;217;239mextract_tokens[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m file_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mFileInfo [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m line_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m byte_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_bytes[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        encoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m encoding_name[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        syntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m TODO: Implement syntax error detection[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        summary_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Apply syntax highlighting to content[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mhighlight_content[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Use cached syntax and theme sets[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m theme [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mok_or[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to load theme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Determine syntax based on file extension or explicit language[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m syntax [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_name[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_extension[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m highlighter [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m,[0m[38;2;248;248;242m theme[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mString[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m [0m[38;2;248;248;242mLinesWithEndings[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfrom[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m ranges[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mStyle, [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            highlighter[0m[38;2;248;248;242m.[0m[38;2;102;217;239mhighlight_line[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m escaped [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mas_24_bit_terminal_escaped[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mranges[0m[38;2;248;248;242m[[0m[38;2;249;38;114m..[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        result[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush_str[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mescaped[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Detect the language of a file based on its extension[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdetect_language[0m[38;2;248;248;242m([0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all supported languages[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m languages[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239msyntaxes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31msyntax[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all available themes[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m themes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mkeys[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcloned[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract summary information from code (function signatures, class definitions, imports)[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_summary[0m[38;2;248;248;242m([0m[38;2;253;151;31mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242m[String], [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;102;217;239mis_important_comment[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mcontinue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-agnostic patterns for important code structures[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    summary[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a line contains summary-worthy code[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Skip empty lines and comments[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-specific important patterns[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mmatch[0m[38;2;248;248;242m language[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_ref[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfrom [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m@[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Only match function/struct/enum declarations, not their contents[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtrait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub trait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimpl [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub const [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstatic [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub static [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mJavaScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m|[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mTypeScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116minterface [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m_[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Generic patterns for unknown languages - only top-level declarations[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mmodule [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a comment is important enough to include in summary[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_important_comment[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_lower [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_lowercase[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtodo[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfixme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mhack[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mnote[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m///[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m/**[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#![0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract tokens from content for AI processing[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_tokens[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31m_file_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Simple token extraction - can be enhanced with proper lexing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Basic word-based tokenization[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239msplit_whitespace[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mextend[0m[38;2;248;248;242m([0m[38;2;248;248;242mline_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Remove duplicates and sort[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdedup[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Limit token count to prevent overflow[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m [0m[38;2;190;132;255m1000[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;190;132;255m1000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    tokens[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mcfg[0m[38;2;248;248;242m([0m[38;2;248;248;242mtest[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;102;217;239mmod[0m[38;2;248;248;242m [0m[38;2;166;226;46mtests[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;249;38;114msuper[0m[38;2;248;248;242m::[0m[38;2;249;38;114m*[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242mWrite[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mtempfile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m NamedTempFile[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to create temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mwrite_all[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to write to temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_basic[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m1[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 2[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m2[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 3[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_lines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 4[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 5[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mshort[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mlonger line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116meven longer line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should stop after first two lines[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes [0m[38;2;249;38;114m<=[0m[38;2;248;248;242m [0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_rust[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_python[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.py[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_unknown[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.unknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_none[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m==[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPlain Text[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_plain[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m,[0m[38;2;248;248;242m content[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_with_syntax[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should contain ANSI escape codes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\x1b[0m[38;2;230;219;116m[[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m languages [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m themes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_summary_mode[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            [0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport os[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mdef main():[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    print('hello')[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    x = 1[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mclass Test:[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    pass[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef main[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass Test[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_include_tokens[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    let x = 42;[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mmain()[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_encoding_detection[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mHello, 世界![0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mencoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_config_default[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mstrip_ansi[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_empty_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_single_line_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m Core functionality for batless - a minimal, AI-friendly code viewer[0m
[38;2;117;113;94m//![0m
[38;2;117;113;94m//![0m[38;2;117;113;94m This library provides the core logic for syntax highlighting and file processing[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m that can be used both by the CLI and in tests.[0m

[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m::[0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfs[0m[38;2;248;248;242m::[0m[38;2;248;248;242mFile[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mBufRead[0m[38;2;248;248;242m,[0m[38;2;248;248;242m BufReader[0m[38;2;248;248;242m,[0m[38;2;248;248;242m Read[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mpath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mPath[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242measy[0m[38;2;248;248;242m::[0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mparsing[0m[38;2;248;248;242m::[0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mutil[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mas_24_bit_terminal_escaped[0m[38;2;248;248;242m,[0m[38;2;248;248;242m LinesWithEndings[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;117;113;94m//[0m[38;2;117;113;94m Cache syntax and theme sets for better performance[0m
[38;2;248;248;242mlazy_static![0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m SyntaxSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults_newlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m ThemeSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mderive[0m[38;2;248;248;242m([0m[38;2;248;248;242mClone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;102;217;239musize[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtheme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mstrip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255muse_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255minclude_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;102;217;239mimpl[0m[38;2;248;248;242m [0m[38;2;248;248;242mDefault [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            theme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            strip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mFileInfo[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mencoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msyntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Read and process a file according to the given configuration[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mprocess_file[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;248;248;242mFileInfo, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Detect encoding[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mvec![0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;190;132;255m1024.[0m[38;2;102;217;239mmin[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmetadata[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114mas[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m bytes_read [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mread[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    buffer[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;248;248;242mbytes_read[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m_encoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m_[0m[38;2;248;248;242m,[0m[38;2;248;248;242m had_errors[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mencoding_rs[0m[38;2;248;248;242m::[0m[38;2;190;132;255mUTF_8[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdecode[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mbuffer[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m encoding_name [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mhad_errors [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUnknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Reset file position[0m
[38;2;248;248;242m    file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m reader [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBufReader[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m all_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m For summary mode processing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m First pass: collect all lines if summary mode or collect limited lines[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line_result [0m[38;2;249;38;114min[0m[38;2;248;248;242m reader[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line_result[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m+[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m +1 for newline[0m

[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            all_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m>=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mif[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m+[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m>[0m[38;2;248;248;242m max_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                    truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        line_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        byte_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m line_bytes[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Process summary if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mextract_summary[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mall_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m If summary mode, replace lines with summary for output[0m
[38;2;248;248;242m        lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Extract tokens if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;249;38;114mref[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;102;217;239mextract_tokens[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m file_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mFileInfo [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m line_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m byte_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_bytes[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        encoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m encoding_name[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        syntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m TODO: Implement syntax error detection[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        summary_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Apply syntax highlighting to content[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mhighlight_content[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Use cached syntax and theme sets[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m theme [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mok_or[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to load theme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Determine syntax based on file extension or explicit language[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m syntax [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_name[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_extension[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m highlighter [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m,[0m[38;2;248;248;242m theme[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mString[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m [0m[38;2;248;248;242mLinesWithEndings[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfrom[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m ranges[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mStyle, [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            highlighter[0m[38;2;248;248;242m.[0m[38;2;102;217;239mhighlight_line[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m escaped [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mas_24_bit_terminal_escaped[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mranges[0m[38;2;248;248;242m[[0m[38;2;249;38;114m..[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        result[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush_str[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mescaped[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Detect the language of a file based on its extension[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdetect_language[0m[38;2;248;248;242m([0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all supported languages[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m languages[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239msyntaxes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31msyntax[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all available themes[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m themes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mkeys[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcloned[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract summary information from code (function signatures, class definitions, imports)[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_summary[0m[38;2;248;248;242m([0m[38;2;253;151;31mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242m[String], [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;102;217;239mis_important_comment[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mcontinue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-agnostic patterns for important code structures[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    summary[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a line contains summary-worthy code[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Skip empty lines and comments[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-specific important patterns[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mmatch[0m[38;2;248;248;242m language[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_ref[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfrom [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m@[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Only match function/struct/enum declarations, not their contents[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtrait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub trait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimpl [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub const [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstatic [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub static [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mJavaScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m|[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mTypeScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116minterface [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m_[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Generic patterns for unknown languages - only top-level declarations[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mmodule [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a comment is important enough to include in summary[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_important_comment[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_lower [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_lowercase[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtodo[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfixme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mhack[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mnote[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m///[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m/**[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#![0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract tokens from content for AI processing[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_tokens[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31m_file_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Simple token extraction - can be enhanced with proper lexing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Basic word-based tokenization[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239msplit_whitespace[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mextend[0m[38;2;248;248;242m([0m[38;2;248;248;242mline_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Remove duplicates and sort[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdedup[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Limit token count to prevent overflow[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m [0m[38;2;190;132;255m1000[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;190;132;255m1000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    tokens[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mcfg[0m[38;2;248;248;242m([0m[38;2;248;248;242mtest[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;102;217;239mmod[0m[38;2;248;248;242m [0m[38;2;166;226;46mtests[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;249;38;114msuper[0m[38;2;248;248;242m::[0m[38;2;249;38;114m*[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242mWrite[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mtempfile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m NamedTempFile[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to create temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mwrite_all[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to write to temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_basic[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m1[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 2[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m2[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 3[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_lines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 4[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 5[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mshort[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mlonger line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116meven longer line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should stop after first two lines[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes [0m[38;2;249;38;114m<=[0m[38;2;248;248;242m [0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_rust[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_python[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.py[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_unknown[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.unknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_none[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m==[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPlain Text[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_plain[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m,[0m[38;2;248;248;242m content[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_with_syntax[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should contain ANSI escape codes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\x1b[0m[38;2;230;219;116m[[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m languages [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m themes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_summary_mode[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            [0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport os[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mdef main():[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    print('hello')[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    x = 1[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mclass Test:[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    pass[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef main[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass Test[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_include_tokens[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    let x = 42;[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mmain()[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_encoding_detection[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mHello, 世界![0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mencoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_config_default[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mstrip_ansi[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_empty_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_single_line_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m Core functionality for batless - a minimal, AI-friendly code viewer[0m
[38;2;117;113;94m//![0m
[38;2;117;113;94m//![0m[38;2;117;113;94m This library provides the core logic for syntax highlighting and file processing[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m that can be used both by the CLI and in tests.[0m

[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m::[0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfs[0m[38;2;248;248;242m::[0m[38;2;248;248;242mFile[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mBufRead[0m[38;2;248;248;242m,[0m[38;2;248;248;242m BufReader[0m[38;2;248;248;242m,[0m[38;2;248;248;242m Read[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mpath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mPath[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242measy[0m[38;2;248;248;242m::[0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mparsing[0m[38;2;248;248;242m::[0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mutil[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mas_24_bit_terminal_escaped[0m[38;2;248;248;242m,[0m[38;2;248;248;242m LinesWithEndings[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;117;113;94m//[0m[38;2;117;113;94m Cache syntax and theme sets for better performance[0m
[38;2;248;248;242mlazy_static![0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m SyntaxSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults_newlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m ThemeSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mderive[0m[38;2;248;248;242m([0m[38;2;248;248;242mClone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;102;217;239musize[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtheme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mstrip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255muse_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255minclude_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;102;217;239mimpl[0m[38;2;248;248;242m [0m[38;2;248;248;242mDefault [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            theme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            strip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mFileInfo[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mencoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msyntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Read and process a file according to the given configuration[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mprocess_file[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;248;248;242mFileInfo, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Detect encoding[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mvec![0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;190;132;255m1024.[0m[38;2;102;217;239mmin[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmetadata[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114mas[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m bytes_read [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mread[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    buffer[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;248;248;242mbytes_read[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m_encoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m_[0m[38;2;248;248;242m,[0m[38;2;248;248;242m had_errors[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mencoding_rs[0m[38;2;248;248;242m::[0m[38;2;190;132;255mUTF_8[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdecode[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mbuffer[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m encoding_name [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mhad_errors [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUnknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Reset file position[0m
[38;2;248;248;242m    file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m reader [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBufReader[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m all_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m For summary mode processing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m First pass: collect all lines if summary mode or collect limited lines[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line_result [0m[38;2;249;38;114min[0m[38;2;248;248;242m reader[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line_result[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m+[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m +1 for newline[0m

[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            all_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m>=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mif[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m+[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m>[0m[38;2;248;248;242m max_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                    truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        line_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        byte_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m line_bytes[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Process summary if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mextract_summary[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mall_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m If summary mode, replace lines with summary for output[0m
[38;2;248;248;242m        lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Extract tokens if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;249;38;114mref[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;102;217;239mextract_tokens[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m file_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mFileInfo [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m line_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m byte_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_bytes[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        encoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m encoding_name[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        syntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m TODO: Implement syntax error detection[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        summary_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Apply syntax highlighting to content[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mhighlight_content[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Use cached syntax and theme sets[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m theme [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mok_or[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to load theme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Determine syntax based on file extension or explicit language[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m syntax [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_name[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_extension[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m highlighter [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m,[0m[38;2;248;248;242m theme[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mString[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m [0m[38;2;248;248;242mLinesWithEndings[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfrom[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m ranges[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mStyle, [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            highlighter[0m[38;2;248;248;242m.[0m[38;2;102;217;239mhighlight_line[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m escaped [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mas_24_bit_terminal_escaped[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mranges[0m[38;2;248;248;242m[[0m[38;2;249;38;114m..[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        result[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush_str[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mescaped[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Detect the language of a file based on its extension[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdetect_language[0m[38;2;248;248;242m([0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all supported languages[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m languages[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239msyntaxes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31msyntax[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all available themes[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m themes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mkeys[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcloned[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract summary information from code (function signatures, class definitions, imports)[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_summary[0m[38;2;248;248;242m([0m[38;2;253;151;31mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242m[String], [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;102;217;239mis_important_comment[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mcontinue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-agnostic patterns for important code structures[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    summary[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a line contains summary-worthy code[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Skip empty lines and comments[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-specific important patterns[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mmatch[0m[38;2;248;248;242m language[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_ref[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfrom [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m@[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Only match function/struct/enum declarations, not their contents[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtrait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub trait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimpl [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub const [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstatic [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub static [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mJavaScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m|[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mTypeScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116minterface [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m_[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Generic patterns for unknown languages - only top-level declarations[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mmodule [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a comment is important enough to include in summary[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_important_comment[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_lower [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_lowercase[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtodo[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfixme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mhack[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mnote[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m///[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m/**[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#![0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract tokens from content for AI processing[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_tokens[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31m_file_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Simple token extraction - can be enhanced with proper lexing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Basic word-based tokenization[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239msplit_whitespace[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mextend[0m[38;2;248;248;242m([0m[38;2;248;248;242mline_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Remove duplicates and sort[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdedup[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Limit token count to prevent overflow[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m [0m[38;2;190;132;255m1000[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;190;132;255m1000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    tokens[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mcfg[0m[38;2;248;248;242m([0m[38;2;248;248;242mtest[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;102;217;239mmod[0m[38;2;248;248;242m [0m[38;2;166;226;46mtests[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;249;38;114msuper[0m[38;2;248;248;242m::[0m[38;2;249;38;114m*[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242mWrite[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mtempfile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m NamedTempFile[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to create temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mwrite_all[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to write to temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_basic[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m1[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 2[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m2[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 3[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_lines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 4[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 5[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mshort[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mlonger line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116meven longer line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should stop after first two lines[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes [0m[38;2;249;38;114m<=[0m[38;2;248;248;242m [0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_rust[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_python[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.py[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_unknown[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.unknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_none[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m==[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPlain Text[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_plain[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m,[0m[38;2;248;248;242m content[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_with_syntax[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should contain ANSI escape codes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\x1b[0m[38;2;230;219;116m[[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m languages [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m themes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_summary_mode[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            [0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport os[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mdef main():[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    print('hello')[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    x = 1[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mclass Test:[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    pass[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef main[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass Test[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_include_tokens[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    let x = 42;[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mmain()[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_encoding_detection[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mHello, 世界![0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mencoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_config_default[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mstrip_ansi[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_empty_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_single_line_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m Core functionality for batless - a minimal, AI-friendly code viewer[0m
[38;2;117;113;94m//![0m
[38;2;117;113;94m//![0m[38;2;117;113;94m This library provides the core logic for syntax highlighting and file processing[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m that can be used both by the CLI and in tests.[0m

[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m::[0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfs[0m[38;2;248;248;242m::[0m[38;2;248;248;242mFile[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mBufRead[0m[38;2;248;248;242m,[0m[38;2;248;248;242m BufReader[0m[38;2;248;248;242m,[0m[38;2;248;248;242m Read[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mpath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mPath[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242measy[0m[38;2;248;248;242m::[0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mparsing[0m[38;2;248;248;242m::[0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mutil[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mas_24_bit_terminal_escaped[0m[38;2;248;248;242m,[0m[38;2;248;248;242m LinesWithEndings[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;117;113;94m//[0m[38;2;117;113;94m Cache syntax and theme sets for better performance[0m
[38;2;248;248;242mlazy_static![0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m SyntaxSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults_newlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m ThemeSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mderive[0m[38;2;248;248;242m([0m[38;2;248;248;242mClone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;102;217;239musize[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtheme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mstrip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255muse_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255minclude_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;102;217;239mimpl[0m[38;2;248;248;242m [0m[38;2;248;248;242mDefault [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            theme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            strip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mFileInfo[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mencoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msyntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Read and process a file according to the given configuration[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mprocess_file[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;248;248;242mFileInfo, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Detect encoding[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mvec![0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;190;132;255m1024.[0m[38;2;102;217;239mmin[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmetadata[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114mas[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m bytes_read [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mread[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    buffer[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;248;248;242mbytes_read[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m_encoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m_[0m[38;2;248;248;242m,[0m[38;2;248;248;242m had_errors[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mencoding_rs[0m[38;2;248;248;242m::[0m[38;2;190;132;255mUTF_8[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdecode[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mbuffer[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m encoding_name [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mhad_errors [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUnknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Reset file position[0m
[38;2;248;248;242m    file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m reader [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBufReader[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m all_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m For summary mode processing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m First pass: collect all lines if summary mode or collect limited lines[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line_result [0m[38;2;249;38;114min[0m[38;2;248;248;242m reader[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line_result[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m+[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m +1 for newline[0m

[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            all_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m>=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mif[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m+[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m>[0m[38;2;248;248;242m max_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                    truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        line_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        byte_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m line_bytes[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Process summary if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mextract_summary[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mall_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m If summary mode, replace lines with summary for output[0m
[38;2;248;248;242m        lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Extract tokens if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;249;38;114mref[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;102;217;239mextract_tokens[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m file_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mFileInfo [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m line_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m byte_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_bytes[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        encoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m encoding_name[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        syntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m TODO: Implement syntax error detection[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        summary_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Apply syntax highlighting to content[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mhighlight_content[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Use cached syntax and theme sets[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m theme [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mok_or[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to load theme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Determine syntax based on file extension or explicit language[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m syntax [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_name[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_extension[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m highlighter [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m,[0m[38;2;248;248;242m theme[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mString[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m [0m[38;2;248;248;242mLinesWithEndings[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfrom[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m ranges[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mStyle, [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            highlighter[0m[38;2;248;248;242m.[0m[38;2;102;217;239mhighlight_line[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m escaped [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mas_24_bit_terminal_escaped[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mranges[0m[38;2;248;248;242m[[0m[38;2;249;38;114m..[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        result[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush_str[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mescaped[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Detect the language of a file based on its extension[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdetect_language[0m[38;2;248;248;242m([0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all supported languages[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m languages[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239msyntaxes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31msyntax[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all available themes[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m themes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mkeys[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcloned[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract summary information from code (function signatures, class definitions, imports)[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_summary[0m[38;2;248;248;242m([0m[38;2;253;151;31mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242m[String], [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;102;217;239mis_important_comment[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mcontinue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-agnostic patterns for important code structures[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    summary[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a line contains summary-worthy code[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Skip empty lines and comments[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-specific important patterns[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mmatch[0m[38;2;248;248;242m language[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_ref[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfrom [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m@[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Only match function/struct/enum declarations, not their contents[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtrait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub trait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimpl [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub const [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstatic [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub static [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mJavaScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m|[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mTypeScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116minterface [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m_[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Generic patterns for unknown languages - only top-level declarations[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mmodule [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a comment is important enough to include in summary[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_important_comment[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_lower [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_lowercase[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtodo[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfixme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mhack[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mnote[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m///[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m/**[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#![0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract tokens from content for AI processing[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_tokens[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31m_file_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Simple token extraction - can be enhanced with proper lexing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Basic word-based tokenization[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239msplit_whitespace[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mextend[0m[38;2;248;248;242m([0m[38;2;248;248;242mline_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Remove duplicates and sort[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdedup[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Limit token count to prevent overflow[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m [0m[38;2;190;132;255m1000[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;190;132;255m1000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    tokens[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mcfg[0m[38;2;248;248;242m([0m[38;2;248;248;242mtest[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;102;217;239mmod[0m[38;2;248;248;242m [0m[38;2;166;226;46mtests[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;249;38;114msuper[0m[38;2;248;248;242m::[0m[38;2;249;38;114m*[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242mWrite[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mtempfile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m NamedTempFile[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to create temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mwrite_all[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to write to temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_basic[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m1[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 2[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m2[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 3[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_lines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 4[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 5[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mshort[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mlonger line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116meven longer line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should stop after first two lines[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes [0m[38;2;249;38;114m<=[0m[38;2;248;248;242m [0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_rust[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_python[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.py[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_unknown[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.unknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_none[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m==[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPlain Text[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_plain[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m,[0m[38;2;248;248;242m content[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_with_syntax[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should contain ANSI escape codes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\x1b[0m[38;2;230;219;116m[[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m languages [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m themes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_summary_mode[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            [0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport os[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mdef main():[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    print('hello')[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    x = 1[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mclass Test:[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    pass[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef main[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass Test[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_include_tokens[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    let x = 42;[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mmain()[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_encoding_detection[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mHello, 世界![0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mencoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_config_default[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mstrip_ansi[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_empty_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_single_line_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m Core functionality for batless - a minimal, AI-friendly code viewer[0m
[38;2;117;113;94m//![0m
[38;2;117;113;94m//![0m[38;2;117;113;94m This library provides the core logic for syntax highlighting and file processing[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m that can be used both by the CLI and in tests.[0m

[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m::[0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfs[0m[38;2;248;248;242m::[0m[38;2;248;248;242mFile[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mBufRead[0m[38;2;248;248;242m,[0m[38;2;248;248;242m BufReader[0m[38;2;248;248;242m,[0m[38;2;248;248;242m Read[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mpath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mPath[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242measy[0m[38;2;248;248;242m::[0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mparsing[0m[38;2;248;248;242m::[0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mutil[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mas_24_bit_terminal_escaped[0m[38;2;248;248;242m,[0m[38;2;248;248;242m LinesWithEndings[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;117;113;94m//[0m[38;2;117;113;94m Cache syntax and theme sets for better performance[0m
[38;2;248;248;242mlazy_static![0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m SyntaxSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults_newlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m ThemeSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mderive[0m[38;2;248;248;242m([0m[38;2;248;248;242mClone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;102;217;239musize[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtheme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mstrip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255muse_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255minclude_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;102;217;239mimpl[0m[38;2;248;248;242m [0m[38;2;248;248;242mDefault [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            theme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            strip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mFileInfo[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mencoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msyntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Read and process a file according to the given configuration[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mprocess_file[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;248;248;242mFileInfo, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Detect encoding[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mvec![0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;190;132;255m1024.[0m[38;2;102;217;239mmin[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmetadata[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114mas[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m bytes_read [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mread[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    buffer[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;248;248;242mbytes_read[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m_encoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m_[0m[38;2;248;248;242m,[0m[38;2;248;248;242m had_errors[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mencoding_rs[0m[38;2;248;248;242m::[0m[38;2;190;132;255mUTF_8[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdecode[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mbuffer[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m encoding_name [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mhad_errors [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUnknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Reset file position[0m
[38;2;248;248;242m    file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m reader [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBufReader[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m all_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m For summary mode processing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m First pass: collect all lines if summary mode or collect limited lines[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line_result [0m[38;2;249;38;114min[0m[38;2;248;248;242m reader[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line_result[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m+[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m +1 for newline[0m

[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            all_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m>=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mif[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m+[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m>[0m[38;2;248;248;242m max_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                    truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        line_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        byte_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m line_bytes[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Process summary if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mextract_summary[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mall_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m If summary mode, replace lines with summary for output[0m
[38;2;248;248;242m        lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Extract tokens if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;249;38;114mref[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;102;217;239mextract_tokens[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m file_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mFileInfo [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m line_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m byte_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_bytes[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        encoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m encoding_name[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        syntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m TODO: Implement syntax error detection[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        summary_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Apply syntax highlighting to content[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mhighlight_content[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Use cached syntax and theme sets[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m theme [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mok_or[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to load theme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Determine syntax based on file extension or explicit language[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m syntax [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_name[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_extension[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m highlighter [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m,[0m[38;2;248;248;242m theme[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mString[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m [0m[38;2;248;248;242mLinesWithEndings[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfrom[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m ranges[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mStyle, [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            highlighter[0m[38;2;248;248;242m.[0m[38;2;102;217;239mhighlight_line[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m escaped [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mas_24_bit_terminal_escaped[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mranges[0m[38;2;248;248;242m[[0m[38;2;249;38;114m..[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        result[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush_str[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mescaped[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Detect the language of a file based on its extension[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdetect_language[0m[38;2;248;248;242m([0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all supported languages[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m languages[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239msyntaxes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31msyntax[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all available themes[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m themes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mkeys[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcloned[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract summary information from code (function signatures, class definitions, imports)[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_summary[0m[38;2;248;248;242m([0m[38;2;253;151;31mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242m[String], [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;102;217;239mis_important_comment[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mcontinue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-agnostic patterns for important code structures[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    summary[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a line contains summary-worthy code[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Skip empty lines and comments[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-specific important patterns[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mmatch[0m[38;2;248;248;242m language[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_ref[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfrom [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m@[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Only match function/struct/enum declarations, not their contents[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtrait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub trait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimpl [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub const [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstatic [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub static [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mJavaScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m|[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mTypeScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116minterface [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m_[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Generic patterns for unknown languages - only top-level declarations[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mmodule [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a comment is important enough to include in summary[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_important_comment[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_lower [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_lowercase[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtodo[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfixme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mhack[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mnote[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m///[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m/**[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#![0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract tokens from content for AI processing[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_tokens[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31m_file_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Simple token extraction - can be enhanced with proper lexing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Basic word-based tokenization[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239msplit_whitespace[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mextend[0m[38;2;248;248;242m([0m[38;2;248;248;242mline_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Remove duplicates and sort[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdedup[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Limit token count to prevent overflow[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m [0m[38;2;190;132;255m1000[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;190;132;255m1000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    tokens[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mcfg[0m[38;2;248;248;242m([0m[38;2;248;248;242mtest[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;102;217;239mmod[0m[38;2;248;248;242m [0m[38;2;166;226;46mtests[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;249;38;114msuper[0m[38;2;248;248;242m::[0m[38;2;249;38;114m*[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242mWrite[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mtempfile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m NamedTempFile[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to create temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mwrite_all[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to write to temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_basic[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m1[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 2[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m2[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 3[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_lines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 4[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 5[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mshort[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mlonger line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116meven longer line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should stop after first two lines[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes [0m[38;2;249;38;114m<=[0m[38;2;248;248;242m [0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_rust[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_python[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.py[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_unknown[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.unknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_none[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m==[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPlain Text[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_plain[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m,[0m[38;2;248;248;242m content[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_with_syntax[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should contain ANSI escape codes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\x1b[0m[38;2;230;219;116m[[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m languages [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m themes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_summary_mode[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            [0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport os[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mdef main():[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    print('hello')[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    x = 1[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mclass Test:[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    pass[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef main[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass Test[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_include_tokens[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    let x = 42;[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mmain()[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_encoding_detection[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mHello, 世界![0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mencoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_config_default[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mstrip_ansi[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_empty_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_single_line_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m Core functionality for batless - a minimal, AI-friendly code viewer[0m
[38;2;117;113;94m//![0m
[38;2;117;113;94m//![0m[38;2;117;113;94m This library provides the core logic for syntax highlighting and file processing[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m that can be used both by the CLI and in tests.[0m

[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m::[0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfs[0m[38;2;248;248;242m::[0m[38;2;248;248;242mFile[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mBufRead[0m[38;2;248;248;242m,[0m[38;2;248;248;242m BufReader[0m[38;2;248;248;242m,[0m[38;2;248;248;242m Read[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mpath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mPath[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242measy[0m[38;2;248;248;242m::[0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mparsing[0m[38;2;248;248;242m::[0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mutil[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mas_24_bit_terminal_escaped[0m[38;2;248;248;242m,[0m[38;2;248;248;242m LinesWithEndings[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;117;113;94m//[0m[38;2;117;113;94m Cache syntax and theme sets for better performance[0m
[38;2;248;248;242mlazy_static![0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m SyntaxSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults_newlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m ThemeSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mderive[0m[38;2;248;248;242m([0m[38;2;248;248;242mClone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;102;217;239musize[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtheme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mstrip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255muse_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255minclude_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;102;217;239mimpl[0m[38;2;248;248;242m [0m[38;2;248;248;242mDefault [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            theme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            strip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mFileInfo[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mencoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msyntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Read and process a file according to the given configuration[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mprocess_file[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;248;248;242mFileInfo, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Detect encoding[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mvec![0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;190;132;255m1024.[0m[38;2;102;217;239mmin[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmetadata[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114mas[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m bytes_read [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mread[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    buffer[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;248;248;242mbytes_read[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m_encoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m_[0m[38;2;248;248;242m,[0m[38;2;248;248;242m had_errors[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mencoding_rs[0m[38;2;248;248;242m::[0m[38;2;190;132;255mUTF_8[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdecode[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mbuffer[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m encoding_name [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mhad_errors [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUnknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Reset file position[0m
[38;2;248;248;242m    file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m reader [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBufReader[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m all_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m For summary mode processing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m First pass: collect all lines if summary mode or collect limited lines[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line_result [0m[38;2;249;38;114min[0m[38;2;248;248;242m reader[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line_result[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m+[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m +1 for newline[0m

[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            all_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m>=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mif[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m+[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m>[0m[38;2;248;248;242m max_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                    truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        line_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        byte_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m line_bytes[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Process summary if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mextract_summary[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mall_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m If summary mode, replace lines with summary for output[0m
[38;2;248;248;242m        lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Extract tokens if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;249;38;114mref[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;102;217;239mextract_tokens[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m file_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mFileInfo [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m line_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m byte_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_bytes[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        encoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m encoding_name[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        syntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m TODO: Implement syntax error detection[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        summary_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Apply syntax highlighting to content[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mhighlight_content[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Use cached syntax and theme sets[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m theme [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mok_or[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to load theme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Determine syntax based on file extension or explicit language[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m syntax [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_name[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_extension[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m highlighter [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m,[0m[38;2;248;248;242m theme[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mString[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m [0m[38;2;248;248;242mLinesWithEndings[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfrom[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m ranges[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mStyle, [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            highlighter[0m[38;2;248;248;242m.[0m[38;2;102;217;239mhighlight_line[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m escaped [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mas_24_bit_terminal_escaped[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mranges[0m[38;2;248;248;242m[[0m[38;2;249;38;114m..[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        result[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush_str[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mescaped[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Detect the language of a file based on its extension[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdetect_language[0m[38;2;248;248;242m([0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all supported languages[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m languages[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239msyntaxes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31msyntax[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all available themes[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m themes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mkeys[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcloned[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract summary information from code (function signatures, class definitions, imports)[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_summary[0m[38;2;248;248;242m([0m[38;2;253;151;31mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242m[String], [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;102;217;239mis_important_comment[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mcontinue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-agnostic patterns for important code structures[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    summary[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a line contains summary-worthy code[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Skip empty lines and comments[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-specific important patterns[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mmatch[0m[38;2;248;248;242m language[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_ref[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfrom [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m@[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Only match function/struct/enum declarations, not their contents[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtrait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub trait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimpl [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub const [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstatic [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub static [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mJavaScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m|[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mTypeScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116minterface [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m_[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Generic patterns for unknown languages - only top-level declarations[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mmodule [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a comment is important enough to include in summary[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_important_comment[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_lower [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_lowercase[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtodo[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfixme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mhack[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mnote[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m///[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m/**[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#![0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract tokens from content for AI processing[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_tokens[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31m_file_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Simple token extraction - can be enhanced with proper lexing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Basic word-based tokenization[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239msplit_whitespace[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mextend[0m[38;2;248;248;242m([0m[38;2;248;248;242mline_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Remove duplicates and sort[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdedup[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Limit token count to prevent overflow[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m [0m[38;2;190;132;255m1000[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;190;132;255m1000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    tokens[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mcfg[0m[38;2;248;248;242m([0m[38;2;248;248;242mtest[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;102;217;239mmod[0m[38;2;248;248;242m [0m[38;2;166;226;46mtests[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;249;38;114msuper[0m[38;2;248;248;242m::[0m[38;2;249;38;114m*[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242mWrite[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mtempfile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m NamedTempFile[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to create temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mwrite_all[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to write to temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_basic[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m1[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 2[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m2[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 3[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_lines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 4[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 5[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mshort[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mlonger line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116meven longer line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should stop after first two lines[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes [0m[38;2;249;38;114m<=[0m[38;2;248;248;242m [0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_rust[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_python[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.py[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_unknown[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.unknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_none[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m==[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPlain Text[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_plain[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m,[0m[38;2;248;248;242m content[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_with_syntax[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should contain ANSI escape codes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\x1b[0m[38;2;230;219;116m[[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m languages [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m themes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_summary_mode[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            [0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport os[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mdef main():[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    print('hello')[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    x = 1[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mclass Test:[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    pass[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef main[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass Test[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_include_tokens[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    let x = 42;[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mmain()[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_encoding_detection[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mHello, 世界![0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mencoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_config_default[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mstrip_ansi[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_empty_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_single_line_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m Core functionality for batless - a minimal, AI-friendly code viewer[0m
[38;2;117;113;94m//![0m
[38;2;117;113;94m//![0m[38;2;117;113;94m This library provides the core logic for syntax highlighting and file processing[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m that can be used both by the CLI and in tests.[0m

[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m::[0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfs[0m[38;2;248;248;242m::[0m[38;2;248;248;242mFile[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mBufRead[0m[38;2;248;248;242m,[0m[38;2;248;248;242m BufReader[0m[38;2;248;248;242m,[0m[38;2;248;248;242m Read[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mpath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mPath[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242measy[0m[38;2;248;248;242m::[0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mparsing[0m[38;2;248;248;242m::[0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mutil[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mas_24_bit_terminal_escaped[0m[38;2;248;248;242m,[0m[38;2;248;248;242m LinesWithEndings[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;117;113;94m//[0m[38;2;117;113;94m Cache syntax and theme sets for better performance[0m
[38;2;248;248;242mlazy_static![0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m SyntaxSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults_newlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m ThemeSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mderive[0m[38;2;248;248;242m([0m[38;2;248;248;242mClone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;102;217;239musize[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtheme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mstrip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255muse_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255minclude_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;102;217;239mimpl[0m[38;2;248;248;242m [0m[38;2;248;248;242mDefault [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            theme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            strip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mFileInfo[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mencoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msyntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Read and process a file according to the given configuration[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mprocess_file[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;248;248;242mFileInfo, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Detect encoding[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mvec![0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;190;132;255m1024.[0m[38;2;102;217;239mmin[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmetadata[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114mas[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m bytes_read [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mread[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    buffer[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;248;248;242mbytes_read[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m_encoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m_[0m[38;2;248;248;242m,[0m[38;2;248;248;242m had_errors[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mencoding_rs[0m[38;2;248;248;242m::[0m[38;2;190;132;255mUTF_8[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdecode[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mbuffer[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m encoding_name [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mhad_errors [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUnknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Reset file position[0m
[38;2;248;248;242m    file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m reader [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBufReader[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m all_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m For summary mode processing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m First pass: collect all lines if summary mode or collect limited lines[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line_result [0m[38;2;249;38;114min[0m[38;2;248;248;242m reader[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line_result[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m+[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m +1 for newline[0m

[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            all_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m>=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mif[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m+[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m>[0m[38;2;248;248;242m max_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                    truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        line_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        byte_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m line_bytes[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Process summary if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mextract_summary[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mall_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m If summary mode, replace lines with summary for output[0m
[38;2;248;248;242m        lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Extract tokens if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;249;38;114mref[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;102;217;239mextract_tokens[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m file_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mFileInfo [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m line_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m byte_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_bytes[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        encoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m encoding_name[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        syntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m TODO: Implement syntax error detection[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        summary_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Apply syntax highlighting to content[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mhighlight_content[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Use cached syntax and theme sets[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m theme [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mok_or[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to load theme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Determine syntax based on file extension or explicit language[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m syntax [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_name[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_extension[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m highlighter [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m,[0m[38;2;248;248;242m theme[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mString[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m [0m[38;2;248;248;242mLinesWithEndings[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfrom[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m ranges[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mStyle, [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            highlighter[0m[38;2;248;248;242m.[0m[38;2;102;217;239mhighlight_line[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m escaped [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mas_24_bit_terminal_escaped[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mranges[0m[38;2;248;248;242m[[0m[38;2;249;38;114m..[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        result[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush_str[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mescaped[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Detect the language of a file based on its extension[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdetect_language[0m[38;2;248;248;242m([0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all supported languages[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m languages[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239msyntaxes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31msyntax[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all available themes[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m themes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mkeys[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcloned[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract summary information from code (function signatures, class definitions, imports)[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_summary[0m[38;2;248;248;242m([0m[38;2;253;151;31mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242m[String], [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;102;217;239mis_important_comment[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mcontinue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-agnostic patterns for important code structures[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    summary[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a line contains summary-worthy code[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Skip empty lines and comments[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-specific important patterns[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mmatch[0m[38;2;248;248;242m language[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_ref[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfrom [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m@[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Only match function/struct/enum declarations, not their contents[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtrait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub trait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimpl [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub const [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstatic [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub static [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mJavaScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m|[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mTypeScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116minterface [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m_[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Generic patterns for unknown languages - only top-level declarations[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mmodule [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a comment is important enough to include in summary[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_important_comment[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_lower [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_lowercase[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtodo[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfixme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mhack[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mnote[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m///[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m/**[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#![0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract tokens from content for AI processing[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_tokens[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31m_file_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Simple token extraction - can be enhanced with proper lexing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Basic word-based tokenization[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239msplit_whitespace[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mextend[0m[38;2;248;248;242m([0m[38;2;248;248;242mline_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Remove duplicates and sort[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdedup[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Limit token count to prevent overflow[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m [0m[38;2;190;132;255m1000[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;190;132;255m1000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    tokens[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mcfg[0m[38;2;248;248;242m([0m[38;2;248;248;242mtest[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;102;217;239mmod[0m[38;2;248;248;242m [0m[38;2;166;226;46mtests[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;249;38;114msuper[0m[38;2;248;248;242m::[0m[38;2;249;38;114m*[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242mWrite[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mtempfile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m NamedTempFile[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to create temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mwrite_all[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to write to temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_basic[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m1[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 2[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m2[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 3[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_lines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 4[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 5[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mshort[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mlonger line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116meven longer line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should stop after first two lines[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes [0m[38;2;249;38;114m<=[0m[38;2;248;248;242m [0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_rust[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_python[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.py[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_unknown[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.unknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_none[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m==[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPlain Text[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_plain[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m,[0m[38;2;248;248;242m content[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_with_syntax[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should contain ANSI escape codes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\x1b[0m[38;2;230;219;116m[[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m languages [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m themes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_summary_mode[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            [0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport os[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mdef main():[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    print('hello')[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    x = 1[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mclass Test:[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    pass[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef main[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass Test[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_include_tokens[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    let x = 42;[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mmain()[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_encoding_detection[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mHello, 世界![0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mencoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_config_default[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mstrip_ansi[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_empty_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_single_line_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m Core functionality for batless - a minimal, AI-friendly code viewer[0m
[38;2;117;113;94m//![0m
[38;2;117;113;94m//![0m[38;2;117;113;94m This library provides the core logic for syntax highlighting and file processing[0m
[38;2;117;113;94m//![0m[38;2;117;113;94m that can be used both by the CLI and in tests.[0m

[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m::[0m[38;2;248;248;242mlazy_static[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfs[0m[38;2;248;248;242m::[0m[38;2;248;248;242mFile[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mBufRead[0m[38;2;248;248;242m,[0m[38;2;248;248;242m BufReader[0m[38;2;248;248;242m,[0m[38;2;248;248;242m Read[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mpath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mPath[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242measy[0m[38;2;248;248;242m::[0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mparsing[0m[38;2;248;248;242m::[0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m;[0m
[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mutil[0m[38;2;248;248;242m::[0m[38;2;248;248;242m{[0m[38;2;248;248;242mas_24_bit_terminal_escaped[0m[38;2;248;248;242m,[0m[38;2;248;248;242m LinesWithEndings[0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;117;113;94m//[0m[38;2;117;113;94m Cache syntax and theme sets for better performance[0m
[38;2;248;248;242mlazy_static![0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m SyntaxSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mSyntaxSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults_newlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mstatic[0m[38;2;248;248;242m [0m[38;2;249;38;114mref[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m:[0m[38;2;248;248;242m ThemeSet [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mThemeSet[0m[38;2;248;248;242m::[0m[38;2;248;248;242mload_defaults[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mderive[0m[38;2;248;248;242m([0m[38;2;248;248;242mClone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mmax_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;102;217;239musize[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtheme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mstrip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255muse_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255minclude_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;102;217;239mimpl[0m[38;2;248;248;242m [0m[38;2;248;248;242mDefault [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m [0m[38;2;166;226;46mBatlessConfig[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mSelf[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            theme[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            strip_ansi[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mstruct[0m[38;2;248;248;242m [0m[38;2;166;226;46mFileInfo[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtotal_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtruncated_by_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mencoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m String,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msyntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255mtokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;255;255;255msummary_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Read and process a file according to the given configuration[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mprocess_file[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;248;248;242mFileInfo, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Detect encoding[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mvec![0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;190;132;255m1024.[0m[38;2;102;217;239mmin[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmetadata[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114mas[0m[38;2;248;248;242m [0m[38;2;102;217;239musize[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m bytes_read [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mread[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;249;38;114mmut[0m[38;2;248;248;242m buffer[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    buffer[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;248;248;242mbytes_read[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m_encoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m_[0m[38;2;248;248;242m,[0m[38;2;248;248;242m had_errors[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mencoding_rs[0m[38;2;248;248;242m::[0m[38;2;190;132;255mUTF_8[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdecode[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mbuffer[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m encoding_name [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mhad_errors [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUnknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Reset file position[0m
[38;2;248;248;242m    file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mopen[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m reader [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBufReader[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m all_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m For summary mode processing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m First pass: collect all lines if summary mode or collect limited lines[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line_result [0m[38;2;249;38;114min[0m[38;2;248;248;242m reader[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line_result[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m+[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m +1 for newline[0m

[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            all_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m line_count [0m[38;2;249;38;114m>=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                truncated_by_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                [0m[38;2;249;38;114mif[0m[38;2;248;248;242m byte_count [0m[38;2;249;38;114m+[0m[38;2;248;248;242m line_bytes [0m[38;2;249;38;114m>[0m[38;2;248;248;242m max_bytes [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                    truncated [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    truncated_by_bytes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114mbreak[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m                [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        line_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        byte_count [0m[38;2;249;38;114m+=[0m[38;2;248;248;242m line_bytes[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Process summary if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary_lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mextract_summary[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mall_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m If summary mode, replace lines with summary for output[0m
[38;2;248;248;242m        lines [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Extract tokens if requested[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;249;38;114mref[0m[38;2;248;248;242m summary[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m summary_lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m                lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mjoin[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;102;217;239mextract_tokens[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m file_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mFileInfo [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m line_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        total_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m byte_count[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        truncated_by_bytes[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        language[0m[38;2;248;248;242m:[0m[38;2;248;248;242m config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        encoding[0m[38;2;248;248;242m:[0m[38;2;248;248;242m encoding_name[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        syntax_errors[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m TODO: Implement syntax error detection[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m        summary_lines[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Apply syntax highlighting to content[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mhighlight_content[0m[38;2;248;248;242m([0m
[38;2;248;248;242m    [0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m    [0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mBatlessConfig,[0m
[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mResult[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m, [0m[38;2;166;226;46mBox[0m[38;2;248;248;242m<[0m[38;2;248;248;242mdyn [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242merror[0m[38;2;248;248;242m::[0m[38;2;248;248;242mError[0m[38;2;248;248;242m>[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Use cached syntax and theme sets[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m theme [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mget[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mok_or[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to load theme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Determine syntax based on file extension or explicit language[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m syntax [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_name[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mor_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_by_extension[0m[38;2;248;248;242m([0m[38;2;248;248;242mlang[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap_or_else[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_plain_text[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m highlighter [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mHighlightLines[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m,[0m[38;2;248;248;242m theme[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mString[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m [0m[38;2;248;248;242mLinesWithEndings[0m[38;2;248;248;242m::[0m[38;2;248;248;242mfrom[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m ranges[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntect[0m[38;2;248;248;242m::[0m[38;2;248;248;242mhighlighting[0m[38;2;248;248;242m::[0m[38;2;248;248;242mStyle, [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            highlighter[0m[38;2;248;248;242m.[0m[38;2;102;217;239mhighlight_line[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m)[0m[38;2;249;38;114m?[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m escaped [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mas_24_bit_terminal_escaped[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mranges[0m[38;2;248;248;242m[[0m[38;2;249;38;114m..[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        result[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush_str[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;248;248;242mescaped[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Detect the language of a file based on its extension[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mdetect_language[0m[38;2;248;248;242m([0m[38;2;253;151;31mfile_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mPath[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;166;226;46mOk[0m[38;2;248;248;242m([0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m[38;2;248;248;242m.[0m[38;2;102;217;239mfind_syntax_for_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mpath[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m[38;2;248;248;242m [0m[38;2;249;38;114melse[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mNone[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all supported languages[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m languages[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mSYNTAX_SET[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239msyntaxes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31msyntax[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242msyntax[0m[38;2;248;248;242m.[0m[38;2;248;248;242mname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    languages[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Get list of all available themes[0m
[38;2;249;38;114mpub[0m[38;2;248;248;242m [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m themes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;190;132;255mTHEME_SET[0m[38;2;248;248;242m.[0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mkeys[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcloned[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    themes[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract summary information from code (function signatures, class definitions, imports)[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_summary[0m[38;2;248;248;242m([0m[38;2;253;151;31mlines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242m[String], [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m lines [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;249;38;114m![0m[38;2;102;217;239mis_important_comment[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;249;38;114mcontinue[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-agnostic patterns for important code structures[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mif[0m[38;2;248;248;242m [0m[38;2;102;217;239mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary[0m[38;2;248;248;242m.[0m[38;2;102;217;239mpush[0m[38;2;248;248;242m([0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mclone[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    summary[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a line contains summary-worthy code[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_summary_worthy[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31mlanguage[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;166;226;46mOption[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m trimmed [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtrim[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Skip empty lines and comments[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m//[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;249;38;114mreturn[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Language-specific important patterns[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mmatch[0m[38;2;248;248;242m language[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_ref[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfrom [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m@[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Only match function/struct/enum declarations, not their contents[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtrait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub trait [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimpl [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub const [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstatic [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub static [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mJavaScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m|[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mTypeScript[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116minterface [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mconst [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m=>[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m_[0m[38;2;248;248;242m [0m[38;2;249;38;114m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Generic patterns for unknown languages - only top-level declarations[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m:[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfunction [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub fn [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                    [0m[38;2;249;38;114m&&[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m{[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mstruct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub struct [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m [0m[38;2;248;248;242m([0m[38;2;248;248;242mtrimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116menum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mpub enum [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116muse [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mexport [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m                [0m[38;2;249;38;114m||[0m[38;2;248;248;242m trimmed[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mmodule [0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Check if a comment is important enough to include in summary[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mis_important_comment[0m[38;2;248;248;242m([0m[38;2;253;151;31mline[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;102;217;239mbool[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_lower [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_lowercase[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtodo[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mfixme[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mhack[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mnote[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m///[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m/**[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;249;38;114m||[0m[38;2;248;248;242m line_lower[0m[38;2;248;248;242m.[0m[38;2;102;217;239mstarts_with[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116m#![0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m}[0m

[38;2;117;113;94m///[0m[38;2;117;113;94m Extract tokens from content for AI processing[0m
[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mextract_tokens[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m, [0m[38;2;253;151;31m_file_path[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Simple token extraction - can be enhanced with proper lexing[0m
[38;2;248;248;242m    [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Basic word-based tokenization[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mfor[0m[38;2;248;248;242m line [0m[38;2;249;38;114min[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m line_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mVec[0m[38;2;248;248;242m<[0m[38;2;166;226;46mString[0m[38;2;248;248;242m>[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m line[0m[38;2;248;248;242m.[0m[38;2;102;217;239msplit_whitespace[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mmap[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31ms[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242ms[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcollect[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mextend[0m[38;2;248;248;242m([0m[38;2;248;248;242mline_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Remove duplicates and sort[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239msort[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mdedup[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Limit token count to prevent overflow[0m
[38;2;248;248;242m    [0m[38;2;249;38;114mif[0m[38;2;248;248;242m tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m [0m[38;2;190;132;255m1000[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        tokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mtruncate[0m[38;2;248;248;242m([0m[38;2;190;132;255m1000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    tokens[0m
[38;2;248;248;242m}[0m

[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mcfg[0m[38;2;248;248;242m([0m[38;2;248;248;242mtest[0m[38;2;248;248;242m)[0m[38;2;248;248;242m][0m
[38;2;102;217;239mmod[0m[38;2;248;248;242m [0m[38;2;166;226;46mtests[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;249;38;114msuper[0m[38;2;248;248;242m::[0m[38;2;249;38;114m*[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mstd[0m[38;2;248;248;242m::[0m[38;2;248;248;242mio[0m[38;2;248;248;242m::[0m[38;2;248;248;242mWrite[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;249;38;114muse[0m[38;2;248;248;242m [0m[38;2;248;248;242mtempfile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;253;151;31mcontent[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;102;217;239mstr[0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m->[0m[38;2;248;248;242m NamedTempFile[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m [0m[38;2;249;38;114mmut[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mNamedTempFile[0m[38;2;248;248;242m::[0m[38;2;248;248;242mnew[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to create temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m[38;2;248;248;242m.[0m[38;2;102;217;239mwrite_all[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m.[0m[38;2;102;217;239mas_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to write to temporary file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        file[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_basic[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m1[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 2[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m2[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 3[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_lines[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mline 1[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 2[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 3[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 4[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mline 5[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_lines[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m3[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_process_file_max_bytes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mshort[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mlonger line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116meven longer line[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            max_bytes[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should stop after first two lines[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes [0m[38;2;249;38;114m<=[0m[38;2;248;248;242m [0m[38;2;190;132;255m15[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_rust[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_python[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.py[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_detect_language_unknown[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mdetect_language[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.unknown[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mdetected[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_none[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m||[0m[38;2;248;248;242m detected [0m[38;2;249;38;114m==[0m[38;2;248;248;242m [0m[38;2;166;226;46mSome[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mPlain Text[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_plain[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            use_color[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mfalse[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m,[0m[38;2;248;248;242m content[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_highlight_content_with_syntax[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    println!([0m[38;2;190;132;255m\"[0m[38;2;230;219;116mHello[0m[38;2;190;132;255m\"[0m[38;2;230;219;116m);[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mhighlight_content[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mtest.rs[0m[38;2;230;219;116m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;117;113;94m//[0m[38;2;117;113;94m Should contain ANSI escape codes[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;190;132;255m\x1b[0m[38;2;230;219;116m[[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;249;38;114m>[0m[38;2;248;248;242m content[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m languages [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_languages[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mRust[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mlanguages[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mPython[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_list_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m themes [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mlist_themes[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_empty[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mthemes[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_summary_mode[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m
[38;2;248;248;242m            [0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport os[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mdef main():[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    print('hello')[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    x = 1[0m[38;2;190;132;255m\n[0m[38;2;190;132;255m\n[0m[38;2;230;219;116mclass Test:[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    pass[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            summary_mode[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m summary [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_lines[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mimport[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mdef main[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242msummary[0m[38;2;248;248;242m.[0m[38;2;102;217;239miter[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239many[0m[38;2;248;248;242m([0m[38;2;248;248;242m|[0m[38;2;253;151;31mline[0m[38;2;248;248;242m|[0m[38;2;248;248;242m [0m[38;2;248;248;242mline[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mclass Test[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_include_tokens[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn main() {[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m    let x = 42;[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m}[0m[38;2;190;132;255m\n[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m BatlessConfig [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m            include_tokens[0m[38;2;248;248;242m:[0m[38;2;248;248;242m [0m[38;2;190;132;255mtrue[0m[38;2;248;248;242m,[0m
[38;2;248;248;242m            [0m[38;2;249;38;114m..[0m[38;2;166;226;46mDefault[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m        [0m[38;2;248;248;242m}[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mis_some[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m tokens [0m[38;2;249;38;114m=[0m[38;2;248;248;242m result[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239munwrap[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mfn[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mmain()[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mtokens[0m[38;2;248;248;242m.[0m[38;2;102;217;239mcontains[0m[38;2;248;248;242m([0m[38;2;249;38;114m&[0m[38;2;230;219;116m"[0m[38;2;230;219;116mlet[0m[38;2;230;219;116m"[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_string[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_encoding_detection[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mHello, 世界![0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mencoding[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mUTF-8[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_config_default[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m10000[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmax_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlanguage[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;166;226;46mNone[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtheme[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116mbase16-ocean.dark[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242mstrip_ansi[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242muse_color[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242minclude_tokens[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m.[0m[38;2;248;248;242msummary_mode[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_empty_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_bytes[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m0[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m

[38;2;248;248;242m    [0m[38;2;248;248;242m#[0m[38;2;248;248;242m[[0m[38;2;248;248;242mtest[0m[38;2;248;248;242m][0m
[38;2;248;248;242m    [0m[38;2;102;217;239mfn[0m[38;2;248;248;242m [0m[38;2;166;226;46mtest_single_line_file[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m content [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mcreate_test_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mcontent[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m config [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242mBatlessConfig[0m[38;2;248;248;242m::[0m[38;2;248;248;242mdefault[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m file_path [0m[38;2;249;38;114m=[0m[38;2;248;248;242m file[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mpath[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_str[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m
[38;2;248;248;242m            [0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to convert path to string[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;102;217;239mlet[0m[38;2;248;248;242m result [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;102;217;239mprocess_file[0m[38;2;248;248;242m([0m[38;2;248;248;242mfile_path[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m&[0m[38;2;248;248;242mconfig[0m[38;2;248;248;242m)[0m[38;2;248;248;242m.[0m[38;2;102;217;239mexpect[0m[38;2;248;248;242m([0m[38;2;230;219;116m"[0m[38;2;230;219;116mFailed to process file[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m

[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m.[0m[38;2;102;217;239mlen[0m[38;2;248;248;242m([0m[38;2;248;248;242m)[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mlines[0m[38;2;248;248;242m[[0m[38;2;190;132;255m0[0m[38;2;248;248;242m][0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;230;219;116m"[0m[38;2;230;219;116msingle line without newline[0m[38;2;230;219;116m"[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert_eq![0m[38;2;248;248;242m([0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtotal_lines[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;190;132;255m1[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_lines[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m        [0m[38;2;248;248;242massert![0m[38;2;248;248;242m([0m[38;2;249;38;114m![0m[38;2;248;248;242mresult[0m[38;2;248;248;242m.[0m[38;2;248;248;242mtruncated_by_bytes[0m[38;2;248;248;242m)[0m[38;2;248;248;242m;[0m
[38;2;248;248;242m    [0m[38;2;248;248;242m}[0m
[38;2;248;248;242m}[0m
